summary(wine.all)
##### preprocessing #####
wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
#model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 50, A = F))
model <- train(quality ~ ., data = wine.train, method = "J48")
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 20, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 20, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 50, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 100, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = T, M = 200, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 100, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 250, A = T))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 250, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
#wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
plot(model)
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
getwd()
setwd("C:/Users/pavel/Documents/Å kola/Projects/R_projects/R_ML_semestral_project/R_ML_semestral_project_datasets")
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
#wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
wine.all <- select(wine.all, -type)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
confmat[1,1]
confmat[2,1]
confmat[3,2]
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy2 <- confmat[1:1] + confmat[1,2]
for(i in 2:6){
for(j in i-1:i+1){
accuracy2 <- accuracy2 + confmat[i,j]
}
}
accuracy2 <- accuracy2 + confmat[7,6] + confmat[7,7]
accuracy2 <- accuracy2 / sum(confmat)
accuracy2
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
library(dplyr)
library(RWeka)
###### loading data #######
wine.all <- read.csv("winequalityN.csv")
###### analysis ######
head(wine.all)
summary(wine.all)
##### preprocessing #####
wine.all <- wine.all[sample(nrow(wine.all)), ]
wine.all$quality <- as.factor(wine.all$quality)
wine.all[is.na(wine.all$fixed.acidity), "fixed.acidity"] <- mean(wine.all$fixed.acidity, na.rm = T)
wine.all[is.na(wine.all$volatile.acidity), "volatile.acidity"] <- mean(wine.all$volatile.acidity, na.rm = T)
wine.all[is.na(wine.all$citric.acid), "citric.acid"] <- mean(wine.all$citric.acid, na.rm = T)
wine.all[is.na(wine.all$residual.sugar), "residual.sugar"] <- mean(wine.all$residual.sugar, na.rm = T)
wine.all[is.na(wine.all$chlorides), "chlorides"] <- mean(wine.all$chlorides, na.rm = T)
wine.all[is.na(wine.all$pH), "pH"] <- mean(wine.all$pH, na.rm = T)
wine.all[is.na(wine.all$sulphates), "sulphates"] <- mean(wine.all$sulphates, na.rm = T)
summary(wine.all)
plot(wine.all$type)
plot(wine.all$quality)
wine.train <- wine.all[1:3250, ]
wine.test <- wine.all[3251:6497, ]
###### model ######
model <- J48(quality ~ ., data = wine.train, control = Weka_control(R = F, M = 200, A = F))
prediction <- predict(model, wine.test)
references <- wine.test$quality
confmat <- table(prediction, references)
confmat
accuracy2 <- confmat[1:1] + confmat[1,2]
for(i in 2:6){
for(j in (i-1):(i+1)){
accuracy2 <- accuracy2 + confmat[i,j]
}
}
accuracy2 <- accuracy2 + confmat[7,6] + confmat[7,7]
accuracy2 <- accuracy2 / sum(confmat)
accuracy2
accuracy <- sum(diag(confmat)) / sum(confmat)
accuracy
